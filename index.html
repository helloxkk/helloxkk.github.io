<!DOCTYPE html>
<html  lang="zh">
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 4.1.1" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>青宁的博客</title>


    <meta name="description" content="Welcome to Kun blog">
<meta property="og:type" content="website">
<meta property="og:title" content="青宁的博客">
<meta property="og:url" content="http:&#x2F;&#x2F;hellokk.cc&#x2F;index.html">
<meta property="og:site_name" content="青宁的博客">
<meta property="og:description" content="Welcome to Kun blog">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http:&#x2F;&#x2F;hellokk.cc&#x2F;images&#x2F;og_image.png">
<meta property="article:author" content="青宁">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http:&#x2F;&#x2F;hellokk.cc&#x2F;images&#x2F;og_image.png">







<link rel="icon" href="/images/favicon.png">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/css/back-to-top.css">

    
    
    
    
    
    
    
    <link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    
    
    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.png" alt="青宁的博客" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item is-active"
                href="/">Home</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/categories">Categories</a>
                
                <a class="navbar-item"
                href="/tags">Tags</a>
                
                <a class="navbar-item"
                href="/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    <a class="navbar-item" target="_blank" title="Download on GitHub" href="http://github.com/helloxkk/">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                
                <a class="navbar-item search" title="搜索" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main">
    
<div class="card">
    
    <div class="card-image">
        <a href="/2019/12/17/JetPack%20%E7%AE%80%E4%BB%8B/" class="image is-7by1">
            <img class="thumbnail" src="/gallery/thumbnails/JetPack.jpeg" alt="JetPack 简介">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-12-17T08:01:35.734Z">2019-12-17</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/JetPack/">JetPack</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    5 分钟 读完 (大约 691 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/12/17/JetPack%20%E7%AE%80%E4%BB%8B/">JetPack 简介</a>
            
        </h1>
        <div class="content">
            <p><code>JetPack</code>是<code>Google</code>推出的一些库的集合。是<code>Android</code>基础支持库<code>SDK</code>以外的部分<br>从官方的介绍来看。<code>JetPack</code> 总体包含四部分内容：</p>
<p><img src="https://i.ibb.co/wCgP8m1/jetpack-donut.png" alt="jetPack"></p>
<h4 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h4><p><strong><a href="https://developer.android.com/topic/libraries/support-library/packages.html#v7-appcompat" target="_blank" rel="noopener">AppCompat</a></strong> ： 使得支持较低的 <code>Android</code> 版本。从以前继承 <code>Activity</code> 到现在继承 <code>AppCompatActivity</code> 就是属于这一部分。</p>
<p><strong><a href="https://developer.android.com/kotlin/ktx.html" target="_blank" rel="noopener">Android KTX</a></strong>: <code>Kotlin</code> 的扩展支持库</p>
<p><strong><a href="https://developer.android.com/studio/build/multidex.html" target="_blank" rel="noopener">Multidex</a></strong>: 多 <code>dex</code> 文件支持</p>
<p><strong><a href="https://developer.android.com/training/testing/" target="_blank" rel="noopener">Test</a></strong>: 测试支持库</p>
<h4 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h4><p><strong><a href="https://developer.android.com/topic/libraries/data-binding" target="_blank" rel="noopener">Data Binding</a></strong>: <code>MVVM</code>的一种实践</p>
<p><strong><a href="https://developer.android.com/topic/libraries/architecture/lifecycle" target="_blank" rel="noopener">Lifecycles</a></strong>: 管理你的<code>Activity</code> 和 <code>Fragment</code> 生命周期</p>
<p><strong><a href="https://developer.android.com/topic/libraries/architecture/livedata" target="_blank" rel="noopener">LiveData</a></strong>: 通过观察者模式感知数据变化，类比 <code>RxJava</code></p>
<p><strong><a href="https://developer.android.com/guide/navigation" target="_blank" rel="noopener">Navigation</a></strong>: 处理 <code>Fragment</code></p>
<p><strong><a href="https://developer.android.com/topic/libraries/architecture/paging" target="_blank" rel="noopener">Paging</a></strong>: 分页数据加载方案</p>
<p><strong><a href="https://developer.android.com/topic/libraries/architecture/room" target="_blank" rel="noopener">Room</a></strong>: 官方 <code>ORM</code> 库</p>
<p><strong><a href="https://developer.android.com/topic/libraries/architecture/viewmodel" target="_blank" rel="noopener">ViewModel</a></strong>: 通过数据驱动V视图发生改变</p>
<p><strong><a href="https://developer.android.com/topic/libraries/architecture/workmanager" target="_blank" rel="noopener">WorkManager</a></strong>: 管理后台任务</p>
<h4 id="行为"><a href="#行为" class="headerlink" title="行为"></a>行为</h4><p><strong><a href="https://developer.android.com/training/camerax" target="_blank" rel="noopener">Camerax</a></strong>: 轻松地向应用中添加相机功能</p>
<p><strong><a href="https://developer.android.com/reference/android/app/DownloadManager" target="_blank" rel="noopener">DownloadManager</a></strong>: 安排和管理大量下载任务</p>
<p><strong><a href="https://developer.android.com/guide/topics/media-apps/media-apps-overview.html" target="_blank" rel="noopener">Media app</a></strong>： 用于媒体播放和路由（包括 <code>Google Cast</code>）的向后兼容<code>API</code></p>
<p><strong><a href="https://developer.android.com/guide/topics/ui/notifiers/notifications.html" target="_blank" rel="noopener">Notifications</a></strong>: 提供向后兼容的通知 <code>API</code>，支持 <code>Wear</code> 和 <code>Auto</code></p>
<p><strong><a href="https://developer.android.com/guide/topics/permissions/overview" target="_blank" rel="noopener">Permissions</a></strong>: 用于检查和请求应用权限的兼容性 <code>API</code></p>
<p><strong><a href="https://developer.android.com/guide/topics/ui/settings" target="_blank" rel="noopener">Settings</a></strong>: 创建交互式设置屏幕</p>
<p><strong><a href="https://developer.android.com/training/sharing" target="_blank" rel="noopener">Share Action</a></strong>: 提供适合应用操作栏的共享操作。这块在国内使用的不多，都是自己封装或者采用第三方方案。</p>
<p><strong><a href="https://developer.android.com/guide/slices" target="_blank" rel="noopener">Slices</a></strong>: 可以让应用通过外部（其他<code>APP</code>）显示<code>APP</code>界面（通过设备自带的搜索，语音助手等）</p>
<h4 id="界面"><a href="#界面" class="headerlink" title="界面"></a>界面</h4><p>界面部分所包含的东西基本是我们接触的最多的了：</p>
<p><strong><a href="https://developer.android.com/training/animation/" target="_blank" rel="noopener">Animations and Transitions</a></strong>: 动画，界面转场等</p>
<p><strong><a href="https://developer.android.com/guide/topics/ui/look-and-feel/emoji-compat" target="_blank" rel="noopener">Emoji</a></strong>: 在旧版平台上启用最新的表情符号字体</p>
<p><strong><a href="https://developer.android.com/guide/components/fragments" target="_blank" rel="noopener">Fragment</a></strong>: 组件化界面的基本单位</p>
<p><strong><a href="https://developer.android.com/guide/topics/ui/declaring-layout" target="_blank" rel="noopener">Layout</a></strong>: 基础概念</p>
<p><strong><a href="https://developer.android.com/training/material/palette-colors" target="_blank" rel="noopener">Palette-Colors</a></strong>: 从调色板中提取出有用的信息</p>
<p><strong><a href="https://developer.android.com/tv" target="_blank" rel="noopener">TV</a></strong>: 有助于开发 <code>Android TV</code> 应用的组件</p>
<p><strong><a href="https://developer.android.com/wear" target="_blank" rel="noopener">Wear</a></strong>: 有助于开发 <code>Wear</code> 应用的组件</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2019/12/17/JetPack%20%E4%B9%8B%20LiveData/" class="image is-7by1">
            <img class="thumbnail" src="/gallery/thumbnails/LiveData.png" alt="JetPack 之 LiveData">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-12-17T07:44:16.723Z">2019-12-17</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/JetPack/">JetPack</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    18 分钟 读完 (大约 2665 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/12/17/JetPack%20%E4%B9%8B%20LiveData/">JetPack 之 LiveData</a>
            
        </h1>
        <div class="content">
            <h2 id="LiveData"><a href="#LiveData" class="headerlink" title="LiveData"></a>LiveData</h2><blockquote>
<p><code>LiveData</code>是一个可观察的数据持有者类。与常规<code>observable</code>不同，<code>LiveData</code>是生命周期感知的。</p>
</blockquote>
<p>从<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fdeveloper.android.com%2Ftopic%2Flibraries%2Farchitecture%2Flivedata" target="_blank" rel="noopener">官方文档</a>的介绍上我们可以看到俩个关键词：<strong>可观察</strong>、<strong>生命周期感知</strong>。简单来说，Google 给我们提供了一个可以被观察的，并且拥有生命周期感知能力的类。那有什么用呢？</p>
<p>直接上 demo：</p>
<h2 id="入门"><a href="#入门" class="headerlink" title="入门"></a>入门</h2><h3 id="1-1-初级官方-Demo"><a href="#1-1-初级官方-Demo" class="headerlink" title="1.1 初级官方 Demo"></a>1.1 初级官方 Demo</h3><figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NameViewModel</span> : <span class="hljs-type">ViewModel</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// 创建LiveData</span></span><br><span class="line">    <span class="hljs-keyword">val</span> currentName: MutableLiveData&lt;String&gt; <span class="hljs-keyword">by</span> lazy &#123;</span><br><span class="line">        MutableLiveData&lt;String&gt;()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// ViewModel 的其余部分...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NameActivity</span> : <span class="hljs-type">AppCompatActivity</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> model: NameViewModel</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line"></span><br><span class="line">        <span class="hljs-comment">// 获取ViewModel.</span></span><br><span class="line">        model = ViewModelProviders.of(<span class="hljs-keyword">this</span>).<span class="hljs-keyword">get</span>(NameViewModel::<span class="hljs-class"><span class="hljs-keyword">class</span>.<span class="hljs-title">java</span>)</span></span><br><span class="line"></span><br><span class="line">        <span class="hljs-comment">// 创建更新UI的观察者.</span></span><br><span class="line">        <span class="hljs-keyword">val</span> nameObserver = Observer&lt;String&gt; &#123; newName -&gt;</span><br><span class="line">            <span class="hljs-comment">// 更新UI，在本例中是一个TextView.</span></span><br><span class="line">            nameTextView.text = newName</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="hljs-comment">// 观察LiveData，将此活动作为生命周期所有者和观察者传入.</span></span><br><span class="line">        model.currentName.observe(<span class="hljs-keyword">this</span>, nameObserver)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-2-Demo解释"><a href="#1-2-Demo解释" class="headerlink" title="1.2 Demo解释"></a>1.2 Demo解释</h3><p>最开始我们先声明了一个<code>NameViewModel</code>的<code>ViewModel</code>，这部分内容在<code>ViewModel</code>篇有所提及。内部有一个<code>MutableLiveData&lt;String&gt;</code>的成员变量。说白了就是一个<strong><code>LiveData</code>类型的<code>String</code></strong>，我们使用时是借助<code>LiveData</code>的特性，但本质还是用String。</p>
<p>也就是说这里如果我们要用一个<code>List&lt;String&gt;</code>，那么此时就是<code>MutableLiveData&gt;()</code>。</p>
<p><code>Activity</code>之中，我们先获取<code>ViewModel</code>，然后<code>mModel.currentName.observe(...,...)</code>，这里我们就是在<strong>观察</strong><code>LiveData</code>。我们只需要在回调中处理我们自己的UI操作即可了。也就是demo中的<code>mNameTextView.text = newName</code>。</p>
<p><code>LiveData</code>会在每一次<code>postValue(...)</code>或者<code>value=...</code>时，<code>observe()</code>便会回调，哪怕是<code>null</code>。</p>
<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><p>这里有俩个点需要特别注意：</p>
<ol>
<li><code>LiveData</code>是生命周期感知的，在当前的<code>LifecycleOwner</code>不处于活动状态(例如<code>onPasue()</code>、<code>onStop()</code>)时，LiveData是不会回调<code>observe()</code>的，因为没有意义。</li>
<li>如果<code>LiveData</code>没有被<code>observe()</code>，那么此时你调用这个<code>LiveData</code>的<code>postValue(...)/value=...</code>，是<strong>没有任何作用</strong>。这个我们可以在源码中看到。</li>
</ol>
<h2 id="1-3、不同的-LiveData-实现类-系统实现"><a href="#1-3、不同的-LiveData-实现类-系统实现" class="headerlink" title="1.3、不同的 LiveData 实现类 (系统实现)"></a>1.3、不同的 LiveData 实现类 (系统实现)</h2><p><strong>MutableLiveData</strong>：</p>
<p>上文咱们已经见过了，没什么特别的，就是<code>LiveData</code>的实现类。就相当于<code>List</code>和<code>ArrayList</code>的关系。</p>
<p><strong>MediatorLiveData</strong>：</p>
<p><code>MutableLiveData</code>的子类，它是一个比较强大的<code>LiveData</code>，我们的<code>map()</code>、<code>switchMap()</code>都是基于它进行实现的。<br>最大的特点是可以同时监听多个<code>LiveData</code>。</p>
<h2 id="三、进阶"><a href="#三、进阶" class="headerlink" title="三、进阶"></a>三、进阶</h2><h3 id="3-1-map"><a href="#3-1-map" class="headerlink" title="3.1 map()"></a>3.1 map()</h3><p>初用过<code>RxJava</code>的小伙伴，估计会和我一样，被各种“姿势”的操作符所正经，比如常用的：<code>map、flatMap...</code>而<code>LiveData</code>中同样有这样的操作。</p>
<p>一个很常见的场景：我们通过一个唯一<code>id</code>去查询这个<code>id</code>下的实体类，并且要同时展示二者的数据。很简单的业务逻辑，在<code>LiveData</code>中的展示是这样的：</p>
<h4 id="3-1-1-使用"><a href="#3-1-1-使用" class="headerlink" title="3.1.1 使用"></a>3.1.1 使用</h4><figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NameViewModel</span> : <span class="hljs-type">ViewModel</span></span>() &#123;</span><br><span class="line">    <span class="hljs-keyword">val</span> userIdLiveData = MutableLiveData&lt;<span class="hljs-built_in">Long</span>&gt;()</span><br><span class="line">    <span class="hljs-comment">// 伪码:当userIdLiveData发生变化时，userLiveData中的map就会调用，那么我们就可以得到罪行的id</span></span><br><span class="line">    <span class="hljs-keyword">val</span> userLiveData: LiveData&lt;User&gt; = Transformations.map(userIdLiveData) &#123; id-&gt;</span><br><span class="line">        <span class="hljs-comment">// 通过id拿到User，return一个User的实例user</span></span><br><span class="line">        user</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// Activity中</span></span><br><span class="line">mModel.userLiveData.observe(<span class="hljs-keyword">this</span>, Observer &#123; user -&gt;</span><br><span class="line">    <span class="hljs-comment">// user变化后通知mNameTextView更新UI</span></span><br><span class="line">    mNameTextView.text = user.name</span><br><span class="line">&#125;)</span><br><span class="line"><span class="hljs-comment">// 给userIdLiveData设置id为1</span></span><br><span class="line">mModel.userIdLiveData.postValue(<span class="hljs-string">"1"</span>)</span><br></pre></td></tr></table></figure>

<p>针对这个业务场景，我们只需要监听我们用户通知UI变化的<code>LiveData(userLiveData)</code>，然后通过<code>userIdLiveData.postValue(&quot;1&quot;)</code>来驱动数据的变化。</p>
<blockquote>
<p>这里可能和我们传统的<code>MVP</code>的思想并不相同，毕竟<code>MVVM</code>和<code>MVP</code>还是有区别的，而<code>MVVM</code>的这种方式被称之为：<strong>数据驱动</strong>。</p>
</blockquote>
<h4 id="3-1-2-map-源码"><a href="#3-1-2-map-源码" class="headerlink" title="3.1.2 map() 源码"></a>3.1.2 map() 源码</h4><p>我们直接点到<code>Transformations.map()</code>中。</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">@MainThread</span></span><br><span class="line"><span class="hljs-keyword">public</span> static &lt;X, Y&gt; LiveData&lt;Y&gt; map(</span><br><span class="line">        <span class="hljs-meta">@NonNull</span> LiveData&lt;X&gt; source,</span><br><span class="line">        <span class="hljs-meta">@NonNull</span> <span class="hljs-keyword">final</span> Function&lt;X, Y&gt; mapFunction) &#123;</span><br><span class="line">    <span class="hljs-keyword">final</span> MediatorLiveData&lt;Y&gt; result = new MediatorLiveData&lt;&gt;();</span><br><span class="line">    result.addSource(source, new Observer&lt;X&gt;() &#123;</span><br><span class="line">        <span class="hljs-meta">@Override</span></span><br><span class="line">        <span class="hljs-keyword">public</span> void onChanged(<span class="hljs-meta">@Nullable</span> X x) &#123;</span><br><span class="line">            result.setValue(mapFunction.apply(x));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="hljs-keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>很简单，就是使用了<code>MediatorLiveData</code>，然后通过一个高阶函数，将高阶函数返回的内容，<code>set</code>到<code>LiveData</code>上，完成<code>map()</code>。</p>
<p>既然提到了<code>MediatorLiveData</code>，以及它的<code>addSource()</code>的方法，那么我们就来看看它的源码。</p>
<h4 id="3-1-3-MediatorLiveData-源码"><a href="#3-1-3-MediatorLiveData-源码" class="headerlink" title="3.1.3 MediatorLiveData 源码"></a>3.1.3 MediatorLiveData 源码</h4><blockquote>
<p>这部分没啥意思，可以直接跳过看<strong>3.1.4、map() 源码总结</strong>…</p>
</blockquote>
<p>进入<code>MediatorLiveData</code>之中，我们会发现代码比较少。这里抽出俩块比较重点的内容，我们一同来感受一下：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> <span class="hljs-meta">@MainThread</span></span><br><span class="line"><span class="hljs-keyword">public</span> &lt;S&gt; void addSource(<span class="hljs-meta">@NonNull</span> LiveData&lt;S&gt; source, <span class="hljs-meta">@NonNull</span> Observer&lt;? <span class="hljs-keyword">super</span> S&gt; onChanged) &#123;</span><br><span class="line">    Source&lt;S&gt; e = new Source&lt;&gt;(source, onChanged);</span><br><span class="line">    Source&lt;?&gt; existing = mSources.putIfAbsent(source, e);</span><br><span class="line">    <span class="hljs-keyword">if</span> (existing != <span class="hljs-literal">null</span> &amp;&amp; existing.mObserver != onChanged) &#123;</span><br><span class="line">        <span class="hljs-keyword">throw</span> new IllegalArgumentException(</span><br><span class="line">                <span class="hljs-string">"This source was already added with the different observer"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">if</span> (existing != <span class="hljs-literal">null</span>) &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">if</span> (hasActiveObservers()) &#123;</span><br><span class="line">        e.plug();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从这段代码中，我们粗略可以得到一个信息，这里把我们的<code>LiveData</code>和<code>Observer</code>封装成了<code>Source</code>对象，并且这个对象，不能重复添加。</p>
<p>此外，<code>Source</code>的<code>plug()</code>方法，被调用。接下来我们去看一看这个内部类<code>Source</code>的实现：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">private</span> static <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Source</span>&lt;<span class="hljs-type">V</span>&gt; <span class="hljs-title">implements</span> <span class="hljs-title">Observer</span>&lt;<span class="hljs-type">V</span>&gt; </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">final</span> LiveData&lt;V&gt; mLiveData;</span><br><span class="line">    <span class="hljs-keyword">final</span> Observer&lt;? <span class="hljs-keyword">super</span> V&gt; mObserver;</span><br><span class="line">    int mVersion = START_VERSION;</span><br><span class="line"></span><br><span class="line">    Source(LiveData&lt;V&gt; liveData, <span class="hljs-keyword">final</span> Observer&lt;? <span class="hljs-keyword">super</span> V&gt; observer) &#123;</span><br><span class="line">        mLiveData = liveData;</span><br><span class="line">        mObserver = observer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void plug() &#123;</span><br><span class="line">        mLiveData.observeForever(<span class="hljs-keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void unplug() &#123;</span><br><span class="line">        mLiveData.removeObserver(<span class="hljs-keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-meta">@Override</span></span><br><span class="line">    <span class="hljs-keyword">public</span> void onChanged(<span class="hljs-meta">@Nullable</span> V v) &#123;</span><br><span class="line">        <span class="hljs-keyword">if</span> (mVersion != mLiveData.getVersion()) &#123;</span><br><span class="line">            mVersion = mLiveData.getVersion();</span><br><span class="line">            mObserver.onChanged(v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>首先<code>Source</code>是一个观察者，可以看到，我们外部使用的<code>Observer</code>会以<code>Source</code>的成员变量的形式，添加到传入的<code>LiveData</code>中。值得注意的是，这里使用了<code>mLiveData.observeForever(this);</code>。</p>
<p>从<code>observeForever()</code>用法可以看到，我们并没有传递<code>LifecycleOwner</code>，因此它并不具备生命感知能力。从注释中也可见一斑：<code>This means that the given observer will receive all events and will never be automatically removed.</code></p>
<h4 id="3-1-4-map-源码总结"><a href="#3-1-4-map-源码总结" class="headerlink" title="3.1.4 map() 源码总结"></a>3.1.4 map() 源码总结</h4><p>打住，打住吧。其实没必要继续看了。一句话总结：<code>map()</code>的原理就是基于<code>MediatorLiveData</code>，<code>MediatorLiveData</code>内部会将传递进来的<code>LiveData</code>和<code>Observer</code>封装成内部类，然后放在内部维护的一个<code>Map</code>中。并且自动帮我们完成<code>observeForever</code>()和<code>removeObserver()</code>。</p>
<h2 id="3-2-switchMap"><a href="#3-2-switchMap" class="headerlink" title="3.2 switchMap()"></a>3.2 switchMap()</h2><h4 id="3-2-1-使用"><a href="#3-2-1-使用" class="headerlink" title="3.2.1 使用"></a>3.2.1 使用</h4><p><code>switchMap()</code>的场景可以应用在切换<code>LiveData</code>上。这话怎么解释呢？</p>
<p>很常见的业务场景：比如你的业务用的是<code>map()</code>，<code>map()</code>中使用你自己写的络，而且<code>LiveData</code>运行的很良好，抽着烟喝着酒，啥事都没有…就比如，上面<code>map()</code>那样的代码：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">val</span> userLiveData: LiveData&lt;User&gt; = Transformations.map(userIdLiveData) &#123; id-&gt;</span><br><span class="line">    <span class="hljs-comment">// 自己的一段逻辑</span></span><br><span class="line">    user</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-comment">// Activity中</span></span><br><span class="line">mViewModel.userLiveData.observe(<span class="hljs-keyword">this</span>,Observer&#123;-&gt;user</span><br><span class="line">    <span class="hljs-comment">//更新UI</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>突然有一天，这个地方数据结构、UI都没变，唯独变了逻辑。此时你一个同事写好了一个方法，让你替换一下就好了。不过当你调用的时候突然返现，这个方法返回一个<code>LiveData</code>对象！</p>
<p>当然此时我们可以让<code>UI</code>重新<code>observe()</code>这个<code>LiveData</code>对象：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">val</span> otherLiveData:LiveData&lt;User&gt; = <span class="hljs-comment">// 同事的逻辑</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// Activity中重新observe()</span></span><br><span class="line">mViewModel.otherLiveData.observe(<span class="hljs-keyword">this</span>,Observer&#123;-&gt;user</span><br><span class="line">    <span class="hljs-comment">//更新UI</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>可是这样的话，自己之前写的东西不都白费了么？所以此时，我们可以使用<code>switchMap()</code>，我们只需要很少的改动，就可以设配这次需求的变动：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">val</span> userLiveData: LiveData&lt;User&gt; = Transformations.switchMap(userIdLiveData) &#123; id-&gt;</span><br><span class="line">    <span class="hljs-comment">// 直接把同事的代码放在这里即可</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-2、switchMap-源码"><a href="#3-2-2、switchMap-源码" class="headerlink" title="3.2.2、switchMap() 源码"></a>3.2.2、switchMap() 源码</h4><p>有了上边<code>map()</code>源码基础，我们可以很容易的看出<code>switchMap()</code>的端倪：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">@MainThread</span></span><br><span class="line"><span class="hljs-keyword">public</span> static &lt;X, Y&gt; LiveData&lt;Y&gt; switchMap(</span><br><span class="line">        <span class="hljs-meta">@NonNull</span> LiveData&lt;X&gt; source,</span><br><span class="line">        <span class="hljs-meta">@NonNull</span> <span class="hljs-keyword">final</span> Function&lt;X, LiveData&lt;Y&gt;&gt; switchMapFunction) &#123;</span><br><span class="line">    <span class="hljs-keyword">final</span> MediatorLiveData&lt;Y&gt; result = new MediatorLiveData&lt;&gt;();</span><br><span class="line">    result.addSource(source, new Observer&lt;X&gt;() &#123;</span><br><span class="line">        LiveData&lt;Y&gt; mSource;</span><br><span class="line"></span><br><span class="line">        <span class="hljs-meta">@Override</span></span><br><span class="line">        <span class="hljs-keyword">public</span> void onChanged(<span class="hljs-meta">@Nullable</span> X x) &#123;</span><br><span class="line">            <span class="hljs-comment">// 从Function中拿到返回的LiveData，也就是我们新的LiveData(文章背景中同事写的LiveData)</span></span><br><span class="line">            LiveData&lt;Y&gt; newLiveData = switchMapFunction.apply(x);</span><br><span class="line">            <span class="hljs-keyword">if</span> (mSource == newLiveData) &#123;</span><br><span class="line">                <span class="hljs-keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="hljs-comment">// remove掉旧的LiveData</span></span><br><span class="line">            <span class="hljs-keyword">if</span> (mSource != <span class="hljs-literal">null</span>) &#123;</span><br><span class="line">                result.removeSource(mSource);</span><br><span class="line">            &#125;</span><br><span class="line">            mSource = newLiveData;</span><br><span class="line">            <span class="hljs-keyword">if</span> (mSource != <span class="hljs-literal">null</span>) &#123;</span><br><span class="line">                <span class="hljs-comment">// add新的LiveData</span></span><br><span class="line">                result.addSource(mSource, new Observer&lt;Y&gt;() &#123;</span><br><span class="line">                    <span class="hljs-meta">@Override</span></span><br><span class="line">                    <span class="hljs-keyword">public</span> void onChanged(<span class="hljs-meta">@Nullable</span> Y y) &#123;</span><br><span class="line">                        <span class="hljs-comment">// 通知LiveData发生变化</span></span><br><span class="line">                        result.setValue(y);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="hljs-keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们对比一下<code>switchMap()</code>和<code>map()</code>的参数类型：</p>
<ul>
<li><code>Function&lt;X, LiveData&lt;Y&gt;&gt; switchMapFunction</code></li>
<li><code>Function&lt;X, Y&gt; mapFunction</code></li>
</ul>
<p>很明显一个是返回<strong>LiveData类型</strong>，一个是<strong>换一种类</strong>型。这也说明了，这俩个方法的不一样之处<br>。</p>
<blockquote>
<p>代码解释可以看注释，很直白的思路。</p>
</blockquote>
<h2 id="3-3、MediatorLiveData-的使用"><a href="#3-3、MediatorLiveData-的使用" class="headerlink" title="3.3、MediatorLiveData 的使用"></a>3.3、MediatorLiveData 的使用</h2><p>上述我们看过了<code>map()</code>和<code>switchMap()</code>的用法。各位应该都注意到<code>MediatorLiveData</code>这个类的作用。</p>
<p>上边我们一直都在操作一个<code>LiveData</code>，但是我们需求很容易遇到多种状态的变化。就像官方的<code>demo</code>：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">LiveData liveData1 = ...;</span><br><span class="line">LiveData liveData2 = ...;</span><br><span class="line"></span><br><span class="line">MediatorLiveData liveDataMerger = new MediatorLiveData&lt;&gt;();</span><br><span class="line">liveDataMerger.addSource(liveData1, value -&gt; liveDataMerger.setValue(value));</span><br><span class="line">liveDataMerger.addSource(liveData2, value -&gt; liveDataMerger.setValue(value));</span><br></pre></td></tr></table></figure>

<p>如同<code>demo</code>所示，我们可以同时<code>add</code>多个<code>LiveData</code>，根据不同的<code>LiveData</code>的变化，处理我们不同的逻辑。最后通过<code>MediatorLiveData</code>回调到我们的UI上。</p>
<h2 id="四、源码分析"><a href="#四、源码分析" class="headerlink" title="四、源码分析"></a>四、源码分析</h2><p>注册 Observer</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">@MainThread</span></span><br><span class="line"><span class="hljs-keyword">public</span> void observe(<span class="hljs-meta">@NonNull</span> LifecycleOwner owner, <span class="hljs-meta">@NonNull</span> Observer&lt;? <span class="hljs-keyword">super</span> T&gt; observer) &#123;</span><br><span class="line">    <span class="hljs-comment">// 如果当前生命周期是DESTROYED，直接return</span></span><br><span class="line">    <span class="hljs-keyword">if</span> (owner.getLifecycle().getCurrentState() == DESTROYED) &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-comment">// 这个包装类，做了一件事情，在DESTROYED，移除Observer</span></span><br><span class="line">    LifecycleBoundObserver wrapper = new LifecycleBoundObserver(owner, observer);</span><br><span class="line">    <span class="hljs-comment">// 添加在已经Observer，已存在且在Attach上后直接抛异常，也就是不能重复add</span></span><br><span class="line">    ObserverWrapper existing = mObservers.putIfAbsent(observer, wrapper);</span><br><span class="line">    <span class="hljs-keyword">if</span> (existing != <span class="hljs-literal">null</span> &amp;&amp; !existing.isAttachedTo(owner)) &#123;</span><br><span class="line">        <span class="hljs-keyword">throw</span> new IllegalArgumentException(<span class="hljs-string">"Cannot add the same observer"</span></span><br><span class="line">                + <span class="hljs-string">" with different lifecycles"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">if</span> (existing != <span class="hljs-literal">null</span>) &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-comment">// 把Wrapper添加到LifecycleOwner上</span></span><br><span class="line">    owner.getLifecycle().addObserver(wrapper);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Observer如何被响应：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Observer</span>&lt;<span class="hljs-type">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">     * Called when the data is changed.</span></span><br><span class="line"><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> t  The new data</span></span><br><span class="line"><span class="hljs-comment">     */</span></span><br><span class="line">    void onChanged(T t);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>触发的起点，很明显是我们在<code>set/postValue</code>的时候：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">@MainThread</span></span><br><span class="line"><span class="hljs-keyword">protected</span> void setValue(T value) &#123;</span><br><span class="line">    <span class="hljs-comment">// 记住这个值，它是用来表示数据是否发生变化的</span></span><br><span class="line">    mVersion++;</span><br><span class="line">    mData = value;</span><br><span class="line">    dispatchingValue(<span class="hljs-literal">null</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void dispatchingValue(<span class="hljs-meta">@Nullable</span> ObserverWrapper initiator) &#123;</span><br><span class="line">    <span class="hljs-comment">// 省略部分代码 </span></span><br><span class="line">    <span class="hljs-keyword">for</span> (Iterator&lt;Map.Entry&lt;Observer&lt;? <span class="hljs-keyword">super</span> T&gt;, ObserverWrapper&gt;&gt; iterator =</span><br><span class="line">        mObservers.iteratorWithAdditions(); iterator.hasNext(); ) &#123;</span><br><span class="line">        <span class="hljs-comment">// 往里走</span></span><br><span class="line">        considerNotify(iterator.next().getValue());</span><br><span class="line">        <span class="hljs-keyword">if</span> (mDispatchInvalidated) &#123;</span><br><span class="line">            <span class="hljs-keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-comment">// 省略部分代码</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">private</span> void considerNotify(ObserverWrapper observer) &#123;</span><br><span class="line">    <span class="hljs-comment">// 如果observer不在活动期，则直接return。也就是上述说observer不在前台，将不会接受回调。</span></span><br><span class="line">    <span class="hljs-keyword">if</span> (!observer.mActive) &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-comment">// 省略部分代码</span></span><br><span class="line">    <span class="hljs-comment">// 很直白的version对比</span></span><br><span class="line">    <span class="hljs-keyword">if</span> (observer.mLastVersion &gt;= mVersion) &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    observer.mLastVersion = mVersion;</span><br><span class="line">    <span class="hljs-comment">// 回调</span></span><br><span class="line">    observer.mObserver.onChanged((T) mData);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>observer.mActive</code>在哪被赋值？很多地方。除了一些边界条件的赋值外，一个比较正式的赋值,<code>ObserverWrapper</code>中的<code>void activeStateChanged(boolean newActive)</code>方法：</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">void activeStateChanged(boolean newActive) &#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (newActive == mActive) &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    mActive = newActive;</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-comment">// 此方法最终会调到此方法</span></span><br><span class="line"><span class="hljs-meta">@Override</span></span><br><span class="line">boolean shouldBeActive() &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> mOwner.getLifecycle().getCurrentState().isAtLeast(STARTED);</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">public</span> boolean isAtLeast(<span class="hljs-meta">@NonNull</span> State state) &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> compareTo(state) &gt;= <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>很简单，每次生命周期回调，<code>observer.mActive</code>都会被赋值，而只有到<code>Lifecycle</code>是活动状态是，<code>mActive</code>才会<code>true</code>。因此只有在我们的<code>Activity</code>为前台时我们的<code>LiveData</code>才会被回调。</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2019/03/17/React%20Native%20%E7%BB%84%E4%BB%B6%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/" class="image is-7by1">
            <img class="thumbnail" src="/gallery/thumbnails/react3.gif" alt="React Native 组件生命周期学习总结">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-03-17T15:45:35.218Z">2019-03-17</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/ReactNative/">ReactNative</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    7 分钟 读完 (大约 1025 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/03/17/React%20Native%20%E7%BB%84%E4%BB%B6%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/">React Native 组件生命周期学习总结</a>
            
        </h1>
        <div class="content">
            <p>React Native 中的所有组件存在生命周期，了解其生命周期对于我们掌握一个组件从创建到销毁的整个完整的过程和优化逻辑有很大的帮助。</p>
<p>先来一张经典的生命周期图:</p>
<p><img src="https://i.ibb.co/cYjqn79/React-Life-Cycle.jpg" alt="ReactLifeCycle"></p>
<h2 id="getDefaultProps"><a href="#getDefaultProps" class="headerlink" title="getDefaultProps"></a>getDefaultProps</h2><p><code>getDefaultProps</code> 是创建前的准备工作，来设置默认 <code>props</code> 的值，所以严格地来说，这不是组件的生命周期的一部分。需要注意的是如果有从父组件传过来的同名的 <code>props</code>，那么会覆盖。还有就是多个实例间共享引用，而不是有多个。</p>
<h2 id="getInitialState"><a href="#getInitialState" class="headerlink" title="getInitialState"></a>getInitialState</h2><p>这个函数控件加载之前执行，返回值会被用于 <code>state</code> 的初始化值。</p>
<h2 id="componentWillMount"><a href="#componentWillMount" class="headerlink" title="componentWillMount"></a>componentWillMount</h2><p>这个回调函数在初始化 <code>render</code> 之前执行，调用时机是在组件创建，并初始化了状态之后，在第一次绘制 <code>render()</code> 之前。可以在这里做一些业务初始化操作，也可以设置组件状态 <code>setState</code>。这个函数在整个生命周期中只被调用一次。</p>
<h2 id="render"><a href="#render" class="headerlink" title="render"></a>render</h2><p><code>render</code> 函数会在组件渲染的时候调用，只允许返回一个最外层容器组件。<code>render</code> 函数内要尽量保持纯净，只渲染组件，就是不要这个函数里初始化或更改组件的 <code>state</code> 以及其他耗时的操作。</p>
<h2 id="componentDidMount"><a href="#componentDidMount" class="headerlink" title="componentDidMount"></a>componentDidMount</h2><p>在初始化 <code>render</code> 之后只执行一次，在这个函数内，可以访问任何组件，我们从这个函数开始，就可以和 JS 其他框架交互了，例如设置计时 <code>setTimeout</code> 或者 <code>setInterval</code>，或者发起网络请求，但是需要注意：<strong>RN 框架是先调用子组件的 <code>componentDidMount</code> 函数，然后调用父组件的函数。</strong></p>
<h2 id="shouldComponentUpdate"><a href="#shouldComponentUpdate" class="headerlink" title="shouldComponentUpdate"></a>shouldComponentUpdate</h2><p>我们从上图中可以看出，这个函数在初始化 <code>render</code> 时不会执行，当  <code>props</code> 或者 <code>state</code> 发生变化的时候，才会调用该函数，并且是在<code>render</code>之前。<br>这个函数会返回一个布尔值，如果返回 <code>ture</code>，则进行组件的重新渲染 <code>render</code>，相反返回 <code>false</code>，则不做任何处理。<br>默认情况下，这个函数永远返回 <code>true</code> 用来保证数据变化的时候 UI 能够同步更新。但是在某些特定条件下，我们可以重载这一函数根据传递过来的 <code>props</code> 和 <code>state</code> 来选择是否更新，从而提高性能。</p>
<h2 id="componentWillUpdate"><a href="#componentWillUpdate" class="headerlink" title="componentWillUpdate"></a>componentWillUpdate</h2><p>当 <code>props</code> 和 <code>state</code> 发生变化时执行，并且在 <code>render</code> 函数之前执行，当然初始化 <code>render</code> 时不执行该函数，需要特别注意的是，<strong>在这个函数里面，我们就不能使用 <code>this.setState</code> 来修改状态。</strong>这个函数调用之后，就会把 <code>nextProps</code> 和 <code>nextState</code> 分别设置到 <code>this.props</code> 和 <code>this.state</code> 中。紧接着这个函数，就会调用 <code>render()</code> 来更新界面了。</p>
<h2 id="componentDidUpdate"><a href="#componentDidUpdate" class="headerlink" title="componentDidUpdate"></a>componentDidUpdate</h2><p>这个函数在组件更新渲染完成之后执行，初始化 <code>render</code> 时不执行，<strong>这里也不能使用 this.setState 来修改状态。</strong></p>
<h2 id="componentWillReceiveProps"><a href="#componentWillReceiveProps" class="headerlink" title="componentWillReceiveProps"></a>componentWillReceiveProps</h2><p>这个函数在接收到新的  <code>props</code> 时调用，一般是从父组件传递过来，初始化 <code>render</code> 时不执行，在这个回调函数里面，我们可以根据属性的变化，通过调用 <code>this.setState()</code> 来更新组件状态，旧的属性还是可以通过 <code>this.props</code> 来获取，这里调用更新状态是安全的，并不会触发额外的 <code>render</code> 调用。</p>
<h2 id="componentWillUnmount"><a href="#componentWillUnmount" class="headerlink" title="componentWillUnmount"></a>componentWillUnmount</h2><p>当组件要被从界面上移除的时候，就会调用这个函数，在 <code>componentDidMount</code> 函数里面注册的事件需要在这里取消，例如计时器、网络请求等。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><table>
<thead>
<tr>
<th>生命周期</th>
<th>调用次数</th>
<th>能否使用 setSate()</th>
</tr>
</thead>
<tbody><tr>
<td>getDefaultProps</td>
<td>1</td>
<td>否</td>
</tr>
<tr>
<td>getInitialState</td>
<td>1</td>
<td>否</td>
</tr>
<tr>
<td>componentWillMount</td>
<td>1</td>
<td>是</td>
</tr>
<tr>
<td>render</td>
<td>&gt;=1</td>
<td>否</td>
</tr>
<tr>
<td>componentDidMount</td>
<td>1</td>
<td>是</td>
</tr>
<tr>
<td>shouldComponentUpdate</td>
<td>&gt;=0</td>
<td>否</td>
</tr>
<tr>
<td>componentWillUpdate</td>
<td>&gt;=0</td>
<td>否</td>
</tr>
<tr>
<td>componentDidUpdate</td>
<td>&gt;=0</td>
<td>否</td>
</tr>
<tr>
<td>componentWillReceiveProps</td>
<td>&gt;=0</td>
<td>是</td>
</tr>
<tr>
<td>componentWillUnmount</td>
<td>1</td>
<td>否</td>
</tr>
</tbody></table>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2018/07/25/%E4%BB%BF%E5%BE%AE%E4%BF%A1%E5%89%AA%E5%88%87%E8%A7%86%E9%A2%91%E6%97%B6%E9%95%BFView/" class="image is-7by1">
            <img class="thumbnail" src="/gallery/thumbnails/thumbnail1.jpg" alt="仿微信剪切视频时长View">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-07-25T15:09:02.000Z">2018-07-25</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Android/">Android</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    几秒 读完 (大约 78 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/07/25/%E4%BB%BF%E5%BE%AE%E4%BF%A1%E5%89%AA%E5%88%87%E8%A7%86%E9%A2%91%E6%97%B6%E9%95%BFView/">仿微信剪切视频时长View</a>
            
        </h1>
        <div class="content">
            <h2 id="1-preview"><a href="#1-preview" class="headerlink" title="1. preview"></a>1. preview</h2><p><img src="https://camo.githubusercontent.com/cbe6a0956b09e7a09cba0f8c8cdc4e84ab88cb04/68747470733a2f2f696d672d626c6f672e6373646e2e6e65742f32303138303630363231303635353138363f77617465726d61726b2f322f746578742f6148523063484d364c7939696247396e4c6d4e7a5a473475626d56304c3168724e6a4d794d5463794e7a51342f666f6e742f3561364c354c32542f666f6e7473697a652f3430302f66696c6c2f49304a42516b46434d413d3d2f646973736f6c76652f3730" alt="打赏Gif"></p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2018/06/05/%E4%BD%BF%E7%94%A8%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E8%BF%9B%E8%A1%8C%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86/" class="image is-7by1">
            <img class="thumbnail" src="/gallery/thumbnails/thumbnail3.jpg" alt="使用观察者模式进行订单管理">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-06-05T13:05:10.000Z">2018-06-05</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Android/">Android</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    3 分钟 读完 (大约 509 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/06/05/%E4%BD%BF%E7%94%A8%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E8%BF%9B%E8%A1%8C%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86/">使用观察者模式进行订单管理</a>
            
        </h1>
        <div class="content">
            <p><strong>概念</strong>：观察者模式是由发送者和观察者构成，发送者在状态改变时，主动通知所有的观察者做相应的刷新。<br>观察者模式定义了对象之间一对多的依赖关系，以便一个对象状态发生改变时，所有依赖于它的对象都能够得到通知，并自动刷新。</p>
<figure class="highlight java hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * author: Kun on 2017/12/14 15:34</span></span><br><span class="line"><span class="hljs-comment"> * address: vip@hellokk.cc</span></span><br><span class="line"><span class="hljs-comment"> * description: 订单管理观察者 用户对订单做了操作后，通知所有注册观察者的对象作相应的改变</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OrderManageObserver</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    companion object &#123;</span><br><span class="line">        <span class="hljs-keyword">var</span> list: MutableList&lt;OrderManageListener&gt;? = <span class="hljs-keyword">null</span></span><br><span class="line">        <span class="hljs-keyword">var</span> instance: OrderManageObserver? = <span class="hljs-keyword">null</span></span><br><span class="line">            get() &#123;</span><br><span class="line">                <span class="hljs-keyword">if</span> (field == <span class="hljs-keyword">null</span>) &#123;</span><br><span class="line">					<span class="hljs-comment">// 使用双重锁方式实现单例，保持只有一个实例</span></span><br><span class="line">                    <span class="hljs-keyword">synchronized</span>(OrderManageObserver::<span class="hljs-class"><span class="hljs-keyword">class</span>.<span class="hljs-title">java</span>) </span>&#123;</span><br><span class="line">                        <span class="hljs-keyword">if</span> (field == <span class="hljs-keyword">null</span>)&#123;</span><br><span class="line">                            list = ArrayList()</span><br><span class="line">                        	field = OrderManageObserver()</span><br><span class="line">						&#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="hljs-keyword">return</span> field</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">     * 接受订单</span></span><br><span class="line"><span class="hljs-comment">     */</span></span><br><span class="line">    <span class="hljs-function">fun <span class="hljs-title">orderReceivingClick</span><span class="hljs-params">(orderStep: Int?)</span> </span>&#123;</span><br><span class="line">        list?.forEach &#123;</span><br><span class="line">			<span class="hljs-comment">// 通知所有观察者</span></span><br><span class="line">            it.orderReceiving(orderStep)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">     * 订单删除</span></span><br><span class="line"><span class="hljs-comment">     */</span></span><br><span class="line">    <span class="hljs-function">fun <span class="hljs-title">orderDeleteClick</span><span class="hljs-params">(orderStep: Int?)</span> </span>&#123;</span><br><span class="line">        list?.forEach &#123;</span><br><span class="line">			<span class="hljs-comment">// 通知所有观察者</span></span><br><span class="line">            it.orderDelete(orderStep)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">     * 注册订单监听</span></span><br><span class="line"><span class="hljs-comment">     */</span></span><br><span class="line">    <span class="hljs-function">fun <span class="hljs-title">setOrderClick</span><span class="hljs-params">(orderFace: OrderManageListener)</span> </span>&#123;</span><br><span class="line">        list?.add(orderFace)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>订单管理监听器</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * author: Alan on 2018/1/6 14:01</span></span><br><span class="line"><span class="hljs-comment"> * address: xk6321<span class="hljs-doctag">@gmail</span>.com</span></span><br><span class="line"><span class="hljs-comment"> * description: 订单管理监听器</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">OrderManageListener</span> </span>&#123;</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">orderReceiving</span><span class="hljs-params">(orderStep: <span class="hljs-type">Int</span>?)</span></span> <span class="hljs-comment">// 接受订单</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">orderDelete</span><span class="hljs-params">(orderStep: <span class="hljs-type">Int</span>?)</span></span> <span class="hljs-comment">// 订单删除</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注册观察者</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">OrderManageObserver.instance?.setOrderClick(<span class="hljs-keyword">object</span> : OrderManageListener &#123;</span><br><span class="line">            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">orderReceiving</span><span class="hljs-params">(orderStep: <span class="hljs-type">Int</span>?)</span></span> &#123;</span><br><span class="line">             <span class="hljs-comment">// 在这里做相应操作</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">orderDelete</span><span class="hljs-params">(orderStep: <span class="hljs-type">Int</span>?)</span></span> &#123;</span><br><span class="line">               <span class="hljs-comment">// 订单删除， 刷新列表</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure>

<p>发送者</p>
<figure class="highlight kotlin hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">orderDelSuccess</span><span class="hljs-params">(orderStep: <span class="hljs-type">Int</span>?)</span></span> &#123;</span><br><span class="line">		<span class="hljs-comment">// 在订单删除成功后，通知所有的观察者做相应的操作</span></span><br><span class="line">        OrderManageObserver.instance?.orderDeleteClick(orderStep)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>总结</strong>：观察者模式看起来很高大上，其实说白了就是一个类维护了另一个类的一个集合，并通过这个集合绑定解绑或调用另一个类的方法，对程序的解耦有一定帮助。在这里，我只简单的实现了一下，如果项目比较大，且用的地方比较多的话，在设计底层框架的时候，可以利用多态的特性进行抽象，以便适用与各种场景。</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2018/06/05/Kotlin%20%E4%B8%AD%E4%BD%BF%E7%94%A8%20Anko%20%E7%BC%96%E5%86%99%E5%B8%83%E5%B1%80/" class="image is-7by1">
            <img class="thumbnail" src="/gallery/thumbnails/thumbnail8.jpg" alt="Kotlin 中使用 Anko 编写布局">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-06-05T12:32:14.000Z">2018-06-05</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Kotlin/">Kotlin</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    27 分钟 读完 (大约 4002 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/06/05/Kotlin%20%E4%B8%AD%E4%BD%BF%E7%94%A8%20Anko%20%E7%BC%96%E5%86%99%E5%B8%83%E5%B1%80/">Kotlin 中使用 Anko 编写布局</a>
            
        </h1>
        <div class="content">
            <p>使用 Kotlin 开发已经开发两个项目了。说大幅度的减少了 Java 代码一点不夸张。用 Java 的时候动不动就 new 一个 OnClickListener() 匿名类，动不动就类型转换的地方都可以省下很多。更不用说特殊的地方使用 data class 更是少些不知道多少代码。</p>
<p>Jetbrains 给 Android 带来的不仅是 Kotlin，还有 Anko。从 Anko 的官方说明来看这是一个雄心勃勃的要代替 XML 写 Layout 的新的开发方式。 Anko 最重要的一点是引入了 DSL（Domain Specific Language）的方式开发 Android 界面布局。当然，本质是代码实现布局。不过使用 Anko 完全不用经历 Java 纯代码写 Android 的痛苦。因为本身是来自 Kotlin 的，所以自然的使用这种方式开发就具有了：</p>
<ul>
<li>类型安全，不再需要那么多的 findById() 之后的类型转换。</li>
<li>null 安全，Kotlin 里，如果一个变量用？表示为可空，并且使用？之后再调用的时候，即使变量为空也不会引发异常。</li>
<li>无需设备解析 XML，因为 Anko 本质是代码实现的界面和布局，所以省去了这些麻烦。</li>
<li>代码复用，可以通过继承 AnkoComponent 的方式实现代码复用。XML 布局是每一个 Activity，每一个 View 各自专属一个，代码复用比较少。</li>
</ul>
<p>来一个例子看一下：</p>
<ol>
<li>使用 XML</li>
</ol>
<figure class="highlight xml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">RelativeLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="hljs-tag">&lt;<span class="hljs-name">TextView</span></span></span><br><span class="line"><span class="hljs-tag">        <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/sample_text_view"</span></span></span><br><span class="line"><span class="hljs-tag">        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span></span></span><br><span class="line"><span class="hljs-tag">        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"wrap_content"</span></span></span><br><span class="line"><span class="hljs-tag">        <span class="hljs-attr">android:layout_alignParentTop</span>=<span class="hljs-string">"true"</span></span></span><br><span class="line"><span class="hljs-tag">        <span class="hljs-attr">android:text</span>=<span class="hljs-string">"Sample text view"</span></span></span><br><span class="line"><span class="hljs-tag">        <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">"25sp"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">Button</span></span></span><br><span class="line"><span class="hljs-tag">        <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/sample_button"</span></span></span><br><span class="line"><span class="hljs-tag">        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span></span></span><br><span class="line"><span class="hljs-tag">        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"wrap_content"</span></span></span><br><span class="line"><span class="hljs-tag">        <span class="hljs-attr">android:layout_below</span>=<span class="hljs-string">"@+id/sample_text_view"</span></span></span><br><span class="line"><span class="hljs-tag">        <span class="hljs-attr">android:text</span>=<span class="hljs-string">"Sample button"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>使用 Anko</p>
<pre><code>relativeLayout {
    val textView = textView(&quot;Sample text view&quot;) {
        textSize = 25f
    }.lparams {
        width = matchParent
        alignParentTop()
    }

    button(&quot;Sample button&quot;).lparams {
        width = matchParent
        below(textView)
    }
}</code></pre></li>
</ol>
<p>使用前需要在在 <code>build.gradle</code> 里添加下面的代码：</p>
<pre><code>dependencies {
    compile &apos;org.jetbrains.anko:anko-sdk15:0.8.3&apos; // sdk19, sdk21, sdk23 are also available
    compile &apos;org.jetbrains.anko:anko-support-v4:0.8.3&apos; // In case you need support-v4 bindings
    compile &apos;org.jetbrains.anko:anko-appcompat-v7:0.8.3&apos; // For appcompat-v7 bindings
}</code></pre><p>写一个 ListView 热身<br>首先创建一个 ListView 的 item 点击之后跳转的 activity。这里叫做 TabDemo1。</p>
<p>现在就创建这个 listview，并在 listview 的 item 点击之后调转到相应的 activity 去。<br>这个 listview 非常简单，只在一个竖直的布局中放置，并且宽度和高度都是填满竖直<br>布局。</p>
<pre><code>// 1
verticalLayout {
    padding = dip(16)
    // 2
    val list = listView() {
        // 3
        adapter = ArrayAdapter&lt;String&gt;(this@MainActivity, android.R.layout.simple_list_item_1, items)
        // 4
        onItemClickListener = object : AdapterView.OnItemClickListener {
            override fun onItemClick(parent: AdapterView&lt;*&gt;?, v: View?, position: Int, id: Long) {
                when (position) {
                    0 -&gt; {
                        // 5
                        startActivity&lt;TabDemo1&gt;()
                    }
                }
            }
        }
    }.lparams(width = matchParent) { // 6
        height = matchParent
    }
}</code></pre><p>分别解释：</p>
<ol>
<li>竖直布局。本质是 LinearLayout，并且 orientation 的值为 vertical。但是<br>水平方向的就没有 vetialLayout 这种可以直接使用的了，需要自己写明orientation。</li>
<li>创建一个 listview。</li>
<li>给这个 listview 添加 adapter。这里简单实用 ArrayAdapter<string>。</string></li>
<li>添加 OnItemClickListener。object : AdapterView.OnItemClickListener 用来<br>创建实现某个接口的匿名类。</li>
<li>startActivity<tabdemo1>()，是Anko的语法糖。startActivity(SourceActivity.this, DestActivity.class)<br>可以直接简化为 startActivity<destactivity>()。简单了不少。</destactivity></tabdemo1></li>
<li>在 lparams 中设置 layout params 相关的内容。默认的都是 wrap content。这个设置为<br>宽、高都为 match parent。</li>
</ol>
<p>用 Fragment 写一个 Tab 布局</p>
<p>下面要开发的是一个日记 App。一共有三个 tab，第一个是日记列表，第二个 tab 是写日记，第三个 tab 可以设置一些字体大小等（这里只用来占位，不做实现）。</p>
<p>每一个 tab 都用一个 Fragment 来展示内容。这三个 tab 分别 HomeListFragment, DetailFragment,DiarySettingsFragment。 这三个 fragment 都在一个叫做 TabDemo1 的托管 Activity 里。</p>
<p>现在就从这个托管 activity：TabDemo1 开始。这里我们不使用默认的 ActionBar，而是用完全自定义的方式来写一个我们自己的 action bar。所以需要把界面设定为全屏模式。设置全屏的模式的方法有很多，我们用设置 style 的方式来实现。</p>
<pre><code>&lt;style name=&quot;AppTheme.NoActionBar&quot; parent=&quot;Theme.AppCompat.Light.NoActionBar&quot;&gt;
&lt;/style&gt;</code></pre><p>之后把这个 style 应用在 activity 在 AndroidManifest.xml 配置中。</p>
<p>这个时候这个托管 activity 的界面布局就是一个完全的白板了。这个白板现在要分为上中下三部分。上部为我们自定义的 action bar，最下面的是 tab bar，剩下的部分就是每个 tab 的内容的fragment。</p>
<p>我们来看一下这个布局应该怎么写：</p>
<pre><code>// 1
relativeLayout {
    id = ID_RELATIVELAYOUT

    backgroundColor = Color.LTGRAY

    // 2
    linearLayout {
        id = ID_TOP_BAR
        backgroundColor = ContextCompat.getColor(ctx, R.color.colorPrimary)
        orientation = LinearLayout.HORIZONTAL

        titleTextView = textView {
            text = &quot;Some Title&quot;
            textSize = 16f
            textColor = Color.WHITE
            gravity = Gravity.CENTER_HORIZONTAL or Gravity.CENTER_VERTICAL
        }.lparams {
            width = dip(0)
            height = matchParent
            weight = 1f
        }
    }.lparams {
        width = matchParent
        height = dip(50)
        alignParentTop()
    }

    // 3
    linearLayout {
        id = ID_BOTTOM_TAB_BAR
        orientation = LinearLayout.HORIZONTAL
        backgroundColor = Color.WHITE

        // 4
        homeListTab = weightTextView {
            text = &quot;List&quot;
            normalDrawable = resources.getDrawable(R.mipmap.tab_my_normal)
            selectedDrawable = resources.getDrawable(R.mipmap.tab_my_pressed)
            onClick { tabClick(0) }
        }

        detailTab = weightTextView {
            text = &quot;Detail&quot;
            normalDrawable = resources.getDrawable(R.mipmap.tab_channel_normal)
            selectedDrawable = resources.getDrawable(R.mipmap.tab_channel_pressed)
            onClick { tabClick(1) }
        }

        settingsTab = weightTextView {
            text = &quot;Settings&quot;
            normalDrawable = resources.getDrawable(R.mipmap.tab_better_normal)
            selectedDrawable = resources.getDrawable(R.mipmap.tab_better_pressed)
            onClick { tabClick(2) }
        }

    }.style { // 5
        view -&gt;
        when (view) {
            is TextView -&gt; {
                view.padding = dip(5)
                view.compoundDrawablePadding = dip(3)
                view.textSize = 10f
                view.gravity = Gravity.CENTER
            }
            else -&gt; {
            }
        }
    }.lparams {
        height = dip(50)
        width = matchParent
        alignParentBottom()
    }

    // 6
    fragmentContainer = frameLayout {
        id = ID_FRAMELAYOUT
        backgroundColor = Color.GREEN
    }.lparams {
        below(ID_TOP_BAR)
        above(ID_BOTTOM_TAB_BAR)
        width = matchParent
        height = matchParent
    }
}</code></pre><p>前文的例子用了一个 verticalLayout, 这里用的是 relativeLayout 的布局。<br>这里是自定义 action bar。使用换一个 linearLayout。如前所述，要横向布局 linear layout<br>就需要单独的指定 orientation：orientation =LinearLayout.HORIZONTAL。这里比较简单，只有一个显示 title 的 textView。</p>
<p>这里需要注意 gravity = Gravity.CENTER_HORIZONTAL or Gravity.CENTER_VERTICAL<br> 可以直接写成 gravity = Gravity.CENTER。这里是为了突出or的用法。Kotlin 里的 or<br>就是 java 的 | 操作符的作用。</p>
<p>这部分的布局是 tab bar。</p>
<p>这里用的是 weightTextView 而不是 textView。后面会详细的讲解这一部分。<br>给 tab bar 添加 style。此 style 不是彼 style。这个 style，会遍历 tab bar 的 linear layout 内部的全部的 view，然后根据 when 表达式匹配对应的规则，之后给对应于规则的 view 设置相应的属性。比如，这里会用 when 语句查看 view 是否为 textView，如果是的话就给这个 view 设置 padding、drawable padding、text size 以及 gravity 属性。tab bar 的 linear layout有三个 text view，所以他们都会被设置这些属性。<br>每一个 tab 的内容展示用 fragment 就是这里了。准确的说是 fragment 的 container。<br>这个 container 是一个 framelayout。在 action bar 之下，在 tab bar 之上。在布局的时候有 below(ID_TOP_BAR), above(ID_BOTTOM_TAB_BAR)。ID_TOP_BAR 和 ID_BOTTOM_TAB_BAR 就分别是 action bar 和 tab bar 的 id 值。这些 id 值自由设定。<br>另外，在 java 写的时候常用的 findViewById() 方法在 Kotlin 和 Anko 中可以改为的find<framelayout>(ID_FRAMELAYOUT)。不见得简单，但是增加了类型安全。不用再强制类型转换。也不用担心相关的错误再发生。</framelayout></p>
<p>上文第4点用到了 weightTextView。这是一个自定义的 view。在 Anko 布局中，可以根据自己的需要自定义各种各样的 view。但是，需要经过一个小小的处理之后才可以使用到 Anko 的布局中。这个小小的处理就叫做扩展。下面看看如何给 Anko 添加 weightTextView 扩展的。</p>
<p>首先自定义一个 view：WeightTextView。</p>
<pre><code>class WeightTextView(context: Context) : TextView(context) {
        var normalDrawable: Drawable? = null
        var selectedDrawable: Drawable? = null

        init {
            var layoutParams = LinearLayout.LayoutParams(dip(50),
                    LinearLayout.LayoutParams.MATCH_PARENT, 1f)
            layoutParams.weight = 1f
            this.layoutParams = layoutParams
        }

        override fun setSelected(selected: Boolean) {
            super.setSelected(selected)

            if (selected) {
                this.backgroundColor = ContextCompat.getColor(context, R.color.textGray)
                this.textColor = ContextCompat.getColor(context, R.color.textYellow)

                if (selectedDrawable != null) {
                    this.setCompoundDrawablesWithIntrinsicBounds(null, selectedDrawable, null, null)
                }
            } else {
                this.backgroundColor = ContextCompat.getColor(context, android.R.color.transparent)
                this.textColor = ContextCompat.getColor(context, R.color.textGray)
                if (normalDrawable != null) {
                    this.setCompoundDrawablesWithIntrinsicBounds(null, normalDrawable, null, null)
                }
            }
        }
    }</code></pre><p>附加解释：<br>方法 setSelected() 是被迫添加的。在使用 Anko，相当于使用代码开发 Android 布局的时候 selector 不起作用。只好把点击后的高亮效果写在自定义的 text view 里。</p>
<p>下面看看如何<strong>扩展</strong> Anko，来使用我们上面的自定义 view。</p>
<pre><code>public inline fun ViewManager.weightTextView() = weightTextView {}
public inline fun ViewManager.weightTextView(init: WeightTextView.() -&gt; Unit) = ankoView({ WeightTextView(it) }, init)</code></pre><p>这部分涉及到的语法内容可以参考官网。<br>这里简单介绍一下。拿官网的例子说一下：</p>
<pre><code>class HTML {
    fun body() { ... }
}</code></pre><p>现在有这么一个 HTML 类，那么调用的时候可以这样：</p>
<pre><code>html {       
    body()  
}</code></pre><p>在这么一个 lambda 表达式里就可以直接这样调用 HTML 类的方法了，中间的过程是怎么样的呢</p>
<pre><code>fun html(init: HTML.() -&gt; Unit): HTML {
    val html = HTML()  // create the receiver object
    html.init()        
    return html
}</code></pre><p>其实灰常的简单呢。在方法 html() 里，参数是一个 HTML 类的扩展方法，并且此方法无参，返回 Unit(java的void)。</p>
<p>在方法执行的过程中，首先初始化了 HTML。之后调用了这个作为参数传入的扩展方法。在具体调用 html() 方法的时候，可以只简单写一个 lambda 表达式作为传入的 HTML 扩展方法。既然是一个类的扩展方法，那当然可以调用这个类内部的方法了。</p>
<p>为了帮助理解，这里给出一个参数是方法的方法：</p>
<pre><code>fun main(args: Array&lt;String&gt;) {
    calling(&quot;yo&quot;) { p -&gt;
        println(&quot;method called $p&quot;)
    }

    calling(&quot;yoyo&quot;, ::called)
}

fun calling(param: String, func: (String) -&gt; Unit) {
    func(param)
}

fun called(p: String) {
    println(&quot;output string $p&quot;)
}</code></pre><p>第一个是用 lambda 表达式作为传入方法，第二个是已经定义好的一个方法作为传入方法。</p>
<p>Fragment 的处理<br>本文中的重点在于使用 Anko 做布局，具体的逻辑处理 java 写和 Kotlin 写没有什么区别。这里只简单介绍一下。</p>
<p>为了保证兼容，这里使用 Support v4 来处理 Fragment 的显示等操作。在 activity 的一开始就把需要的 fragemnt 都加载进来。</p>
<pre><code>fun prepareTabFragments() {
    val fm = supportFragmentManager
    homeListFragment = HomeListFragment.newInstance()
    fm.beginTransaction()
            .add(ID_FRAMELAYOUT, homeListFragment)
            .commit()
    detailFragment = DetailFragment.newInstance(null)
    detailFragment?.modelChangeListener = homeListFragment
    fm.beginTransaction()
            .add(ID_FRAMELAYOUT, detailFragment)
            .commit()
    settingsFragment = DiarySettingsFragment.newInstance()
    fm.beginTransaction()
            .add(ID_FRAMELAYOUT, settingsFragment)
            .commit()
}</code></pre><p>每一个 tab 项被点击的时候的处理：</p>
<pre><code>fun tabClick(index: Int) {
    info(&quot;index is $index&quot;)
    val ft = supportFragmentManager.beginTransaction()
    ft.hide(homeListFragment)
    ft.hide(detailFragment)
    ft.hide(settingsFragment)

    // unselect all textviews
    homeListTab?.isSelected = false
    detailTab?.isSelected = false
    settingsTab?.isSelected = false

    when (index) {
        0 -&gt; {
            homeListTab?.isSelected = true
            ft.show(homeListFragment)
        }
        1 -&gt; {
            detailTab?.isSelected = true
            ft.show(detailFragment)
        }
        2 -&gt; {
            settingsTab?.isSelected = true
            ft.show(settingsFragment)
        }
        else -&gt; {

        }
    }

    ft.commit()
}</code></pre><p>分别开始每一个 Fragment<br>在开始之前需要考虑一个很严重的事情：数据存在什么地方。本来应该是 SQLite 或者存在云上的。存在云裳就可以实现同一个账号登录在任何地方都可以同步到同样的内容。这里只简单模拟，存放在 app 的内存里。存放在 Application 派生类 AnkoApplication 的<br>静态属性 diaryDataSource 里。diaryDataSource 是一个 ArrayList 一样的列表。</p>
<pre><code>class AnkoApplication : Application() {

    override fun onCreate() {
        super.onCreate()
    }

    companion object {
        var diaryDataSource = mutableListOf&lt;DiaryModel&gt;()
    }
}</code></pre><p>第一个 tab，HomeListFragment<br>HomeListFragment 类作为第一个 tab 内容展示 fragment，用来显示全部的日记列表的布局就非常简单了，和我们前面的例子没有什么太大的差别。就是在一个 verticalLayout 里放一个 list view。这个 list view 的 data source 只需要一个列表。</p>
<pre><code>// 1
var view = with(ctx) {
    verticalLayout {
        backgroundColor = Color.WHITE

        listView = listView {
            adapter = ArrayAdapter&lt;DiaryModel&gt;(ctx,
                    android.R.layout.simple_list_item_1,
                    AnkoApplication.diaryDataSource)

            onItemClick { adapterView, view, i, l -&gt;
                toast(&quot;clicked index: $i, content: ${AnkoApplication.diaryDataSource[i].toString()}&quot;)
            }
        }

        // 2
        emptyTextView = textView {
            text = resources.getString(R.string.list_view_empty)
            textSize = 30f
            gravity = Gravity.CENTER
        }.lparams {
            width = matchParent
            height = matchParent
        }
    }
}
// 3
listView?.emptyView = emptyTextView

return view</code></pre><p>在 activity 里的布局可以直接写 vertical{}，但是在 fragment 里不可以这样。直接写 vertical{} 就已经把这个layout添加到父 view 上了，这 fragment 里是不行的。在 fragment 里需要创建一个单独的 view，并返回。用 with 语句来创建这样一个单独的 view。<br>在 vertial layout 里添加了一个 textview。<br>上面一步创建的 textview 作为 list view 没有数据的时候显示的 empty view 来使用。<br>第二个 tab，DetailFragment<br>日记的内容包括，日记 title，日记本身的内容还有日记的日期。</p>
<p>所以布局上就包括日记的 title 内容输入用的 EditText 以及为了说明用的 text view，还有 edit text 里的 hint。最后还有一个选择<br>日期的控件。</p>
<pre><code>return with(ctx) {
    verticalLayout {
        padding = dip(10)
        backgroundColor = Color.WHITE
        textView(&quot;TITLE&quot;) {

        }.lparams(width = matchParent)

        titleEditText = editText {
            hint = currentDateString()
            lines = 1
        }.lparams(width = matchParent) {
            topMargin = dip(5)
        }

        textView(&quot;CONTENT&quot;) {

        }.lparams(width = matchParent) {
            topMargin = dip(15)
        }

        contentEditText = editText {
            hint = &quot;what&apos;s going on...&quot;
            setHorizontallyScrolling(false)
        }.lparams(width = matchParent) {
            //                    height = matchParent
            topMargin = dip(5)
        }

        button(R.string.button_select_time) {
            gravity = Gravity.CENTER
            onClick {
                val fm = activity.supportFragmentManager
                var datePicker = DatePickerFragment.newInstance(diaryModel?.date)
                datePicker.setTargetFragment(this@DetailFragment, DetailFragment.REQUEST_DATE)
                datePicker.show(fm, &quot;date&quot;)
            }
        }
        // *
        button(R.string.button_detail_ok) {
            onClick {
                v -&gt;
                println(&quot;ok button clicked&quot;)
                try {
                    var model = diaryModel!!
                    model.title = titleEditText?.text.toString()
                    model.content = contentEditText?.text.toString()
                    AnkoApplication.diaryDataSource.add(model)

                    modelChangeListener?.modelChanged()

                    toast(R.string.model_saved_ok)
                } catch(e: Exception) {
                    Log.d(&quot;##DetailFragment&quot;, &quot;error: ${e.toString()}&quot;)
                    toast(R.string.model_save_error)
                }
            }
        }.lparams {
            topMargin = dip(10)
            width = matchParent
        }
    }.style {
        view -&gt;
        when (view) {
            is Button -&gt; {
                view.gravity = Gravity.CENTER
            }
            is TextView -&gt; {
                view.gravity = Gravity.LEFT
                view.textSize = 20f
                view.textColor = Color.DKGRAY
            }
        }
    }
}</code></pre><p>需要注意打星号的地方。按钮在点击之后会弹出一个 dialog fragment 来显示日期 view。用户可以在这个日期 view 里选择相应的日期。但是，如何从日期 dialog fragment 传递选择的日期给 DetailFragment 呢？这里就涉及到两个 fragment 之间传递数据的问题。</p>
<p>选择日期的dialog fragment是DatePickerFragment。</p>
<pre><code>var pickerView = DatePicker(activity)
pickerView.calendarViewShown = false
pickerView.layoutParams = ViewGroup.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT,
        ViewGroup.LayoutParams.WRAP_CONTENT)
pickerView.init(year, month, day) {
    view, year, month, day -&gt;
    mDate = GregorianCalendar(year, month, day).time

    arguments.putSerializable(EXTRA_DATE, mDate)
}

return AlertDialog.Builder(activity)
        .setView(pickerView)
        .setTitle(R.string.date_picker_title)
        .setPositiveButton(R.string.picker_button_ok) { dialog, which -&gt;
            toast(&quot;hello world!&quot;)
            sendResult(Activity.RESULT_OK)
        }.create()</code></pre><p>首先 DatePickerFragment 要继承 DialogFragment 之后 override 方法 onCreateDialog(savedInstanceState: Bundle)。 在这个方法里使用上面代码创建一个包含日期选择器的 dialog。</p>
<p>在选择日期的时候，会触发 DatePicker 的 OnDateChangedListener 接口的 onDateChanged 方法。我们在这个方法里记录选择好的日期数据，在dialog的positive按钮点击之后把这个数据发送给 DetailFragment。</p>
<p>那么怎么发送呢？使用 target fargment 方法。在 detail fragment 弹出 dialog fragment 的时候，把 detail fragment 设置为 target fragment。</p>
<pre><code>button(R.string.button_select_time) {
    gravity = Gravity.CENTER
    onClick {
        val fm = activity.supportFragmentManager
        var datePicker = DatePickerFragment.newInstance(diaryModel?.date)
        // *
        datePicker.setTargetFragment(this@DetailFragment, DetailFragment.REQUEST_DATE)
        datePicker.show(fm, &quot;date&quot;)
    }
}</code></pre><p>在标星下面的一行代码中。datePicker.setTargetFragment(this@DetailFragment,DetailFragment.REQUEST_DATE)将DetailFragment设定为target fragment，并且指定REQUEST_DATE这code，为以后取出数据使用。</p>
<pre><code>companion object Factory {
    val REQUEST_DATE = 0`
}</code></pre><p>在 positive 按钮点击之后执行方法 sendResult 回传数据</p>
<pre><code>private fun sendResult(resultCode: Int) {
    if (targetFragment == null)
        return

    var i = Intent()
    i.putExtra(EXTRA_DATE, mDate)
    // *
    targetFragment.onActivityResult(targetRequestCode, resultCode, i)
}</code></pre><p>调用 targetFragment 的 onActivityResult() 方法来回传日期数据。</p>
<p>在 DetailFragment 中通过 override 方法 onActivityResult() 来接收数据。</p>
<pre><code>override fun onActivityResult(requestCode: Int, resultCode: Int, data: Intent?) {
    if (resultCode != Activity.RESULT_OK) {
        return
    }

    if (requestCode != REQUEST_DATE) {
        return
    }

    var date = data?.getSerializableExtra(DatePickerFragment.EXTRA_DATE) as Date
    diaryModel?.date = date
}</code></pre><p>日期数据传输这部分到这里结束。</p>
<p>全文也可以在这里画上一个句点了。以上还有很多关于 Anko 没有使用的地方。Anko 也是可以实现代码界面分离的。继承 AnkoComponent 可以写出独立的布局文件，并且可以用 anko preview 插件来预览界面效果。就拿 setting 这个 tab 的 fragment 来举例：<br>首先定义一个独立的布局文件:</p>
<pre><code>class SettingsUI&lt;T&gt; : AnkoComponent&lt;T&gt; {
    override fun createView(ui: AnkoContext&lt;T&gt;) = with(ui) {
        verticalLayout {
            backgroundColor = ContextCompat.getColor(ctx, R.color.SnowWhite)
            textView { text = resources.getString(R.string.settings_title) }

            button(&quot;activity with the same `AnkoComponent`&quot;) {
                id = ID_BUTTON
            }
        }
    }

    companion object Factory {
        public val ID_BUTTON = 101
    }
}</code></pre><p>把这个布局文件用在 DiarySettingsFragment 上：</p>
<pre><code>override fun onCreateView(inflater: LayoutInflater?, container: ViewGroup?,
    val view = SettingsUI&lt;DiarySettingsFragment&gt;().createView(AnkoContext.create(ctx, DiarySettingsFragment()))

    return view
}</code></pre><p>然后这个布局还可以用在我们刚刚创建的 TempActivity 上：</p>
<pre><code>override fun onCreate(savedInstanceState: Bundle?) {
    super.onCreate(savedInstanceState)
    SettingsUI&lt;TempActivity&gt;().setContentView(this)

    val button = find&lt;Button&gt;(SettingsUI.ID_BUTTON)
    button.text = &quot;you are in `TempActivity`, CLICK!&quot;

    button.onClick {
        toast(&quot;${TempActivity::class.java.simpleName}&quot;)
    }
}</code></pre><p>Activity 上使用就简单很多了，只需要这么一句 SettingsUI<tempactivity>().setContentView(this)。</tempactivity></p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2018/05/21/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%87%BD%E6%95%B0%E7%BC%96%E7%A8%8B%20RxJava%20&%20RxAndroid%20/" class="image is-7by1">
            <img class="thumbnail" src="/gallery/thumbnails/rxJava_rxandroid.jpg" alt="响应式函数编程 RxJava &amp; RxAndroid">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-05-21T12:38:54.000Z">2018-05-21</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Android/">Android</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    9 分钟 读完 (大约 1328 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/05/21/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%87%BD%E6%95%B0%E7%BC%96%E7%A8%8B%20RxJava%20&%20RxAndroid%20/">响应式函数编程 RxJava &amp; RxAndroid</a>
            
        </h1>
        <div class="content">
            <ul>
<li><p>Github: <a href="https://github.com/ReactiveX/RxJava" target="_blank" rel="noopener">https://github.com/ReactiveX/RxJava</a></p>
</li>
<li><p>中文资料:</p>
<ul>
<li><a href="https://github.com/lzyzsd/Awesome-RxJava" target="_blank" rel="noopener">https://github.com/lzyzsd/Awesome-RxJava</a></li>
<li><a href="https://www.zhihu.com/question/35511144" target="_blank" rel="noopener">https://www.zhihu.com/question/35511144</a></li>
</ul>
</li>
<li><p>用途:</p>
<ul>
<li>异步操作</li>
<li>在程序逻辑异常复杂的情况下,仍然可以让代码的逻辑保持简洁</li>
</ul>
</li>
<li><p>配置: 添加依赖:</p>
<pre><code>compile &apos;io.reactivex:rxjava:1.1.3&apos;
compile &apos;io.reactivex:rxandroid:1.1.0&apos;

//如果结合Retrofit使用,需要添加以下依赖

compile &apos;com.squareup.retrofit2:retrofit:2.0.1&apos;
compile &apos;com.squareup.retrofit2:converter-gson:2.0.1&apos;
compile &apos;com.squareup.retrofit2:adapter-rxjava:2.0.1&apos;</code></pre></li>
</ul>
<ul>
<li>基本概念:</li>
</ul>
<h2 id="1-被观察者-Observable"><a href="#1-被观察者-Observable" class="headerlink" title="1. 被观察者: Observable"></a>1. 被观察者: Observable</h2><ul>
<li>作用: 决定什么时候触发事件以及触发怎样的事件</li>
<li>创建方法:<ul>
<li>Observable.just(T…) 参数为单个的</li>
<li>Observable.from(T[]) / Observable.from(Iterable&lt;? extends T&gt;)  参数为数组或Iterable</li>
</ul>
</li>
</ul>
<h2 id="2-观察者-Observer"><a href="#2-观察者-Observer" class="headerlink" title="2. 观察者: Observer"></a>2. 观察者: Observer</h2><ul>
<li>作用: 当事件触发的时候将有怎样的行为</li>
<li>实现类有Observer / Subscriber</li>
</ul>
<h2 id="3-订阅-subscribe"><a href="#3-订阅-subscribe" class="headerlink" title="3. 订阅: subscribe"></a>3. 订阅: subscribe</h2><ul>
<li><p>作用: 把Observable和Observer关联起来</p>
</li>
<li><p>方法:</p>
<ul>
<li>observable.subscribe(observer);</li>
<li>observable.subscribe(subscriber);<h2 id="4-事件"><a href="#4-事件" class="headerlink" title="4. 事件:"></a>4. 事件:</h2></li>
</ul>
</li>
<li><p>onNext()：普通事件</p>
</li>
<li><p>onCompleted():事件队列完结</p>
</li>
<li><p>onError(): 事件队列异常</p>
</li>
<li><p>需要注意的是onCompleted()和onError()是互斥的.调用了其中一个就不应该触发另一个.</p>
<h2 id="5-案例"><a href="#5-案例" class="headerlink" title="5. 案例:"></a>5. 案例:</h2></li>
<li><p>现有一个数组 String[] arr ={“afdsa”, “bfdsa”, “cfda”}, 把其中以字母”a”开头的字符串找出来并加上”from Alpha”,最后打印出新的字符串的长度</p>
<pre><code>private void simpleDemo() {

     String[] arr = {&quot;afdsa&quot;, &quot;bfdsa&quot;, &quot;cfda&quot;};

     Observable
             .from(arr)
             .filter(new Func1&lt;String, Boolean&gt;() {
                 @Override
                 public Boolean call(String s) {
                     return s.startsWith(&quot;a&quot;);
                 }
             })
             .map(new Func1&lt;String, String&gt;() {
                 @Override
                 public String call(String s) {
                     return s + &quot; from Alpha&quot;;
                 }
             })
             .subscribe(new Action1&lt;String&gt;() {
                 @Override
                 public void call(String s) {
                     System.out.println(&quot;Rxjava:&quot; + s.length());
                 }
             });

     for (int i = 0; i &lt; arr.length; i++) {
         String temp = arr[i];
         if (temp.startsWith(&quot;a&quot;)) {
             temp += &quot; from Alpha&quot;;
             System.out.println(&quot;Normal:&quot; + temp.length());
         }

     }</code></pre></li>
</ul>
<ul>
<li><p>由指定的一个 drawable 文件 id 取得图片，并显示在 ImageView 中，并在出现异常的时候打印 Toast 报错：</p>
<pre><code>private void simpleDemo() {

    final int drawID = R.mipmap.ic_launcher;
    Observable
            .create(new Observable.OnSubscribe&lt;Drawable&gt;() {
                @Override
                public void call(Subscriber&lt;? super Drawable&gt; subscriber) {
                    Drawable drawable = getResources().getDrawable(drawID);
                    subscriber.onNext(drawable);
                    subscriber.onCompleted();
                }
            })
            .subscribe(new Observer&lt;Drawable&gt;() {
                @Override
                public void onCompleted() {

                }

                @Override
                public void onError(Throwable e) {
                    Toast.makeText(MainActivity.this, &quot;Error&quot;, Toast.LENGTH_SHORT).show();
                }

                @Override
                public void onNext(Drawable drawable) {
                    imageView.setImageDrawable(drawable);
                }
            });
}</code></pre></li>
</ul>
<h2 id="6-Scheduler"><a href="#6-Scheduler" class="headerlink" title="6. Scheduler"></a>6. Scheduler</h2><ul>
<li><p>作用: 控制线程.指定某一段代码在那个线程里运行.</p>
</li>
<li><p>内置的Scheduler:</p>
<ul>
<li>Schedulers.immediate(): 直接在当前线程运行，相当于不指定线程。这是默认的 Scheduler。</li>
<li>Schedulers.newThread(): 总是启用新线程，并在新线程执行操作。</li>
<li>Schedulers.io(): I/O 操作（读写文件、读写数据库、网络信息交互等）所使用的 Scheduler。行为模式和 newThread() 差不多，区别在于 io() 的内部实现是是用一个无数量上限的线程池，可以重用空闲的线程，因此多数情况下 io() 比 newThread() 更有效率。不要把计算工作放在 io() 中，可以避免创建不必要的线程。</li>
<li>Schedulers.computation(): 计算所使用的 Scheduler。这个计算指的是 CPU 密集型计算，即不会被 I/O 等操作限制性能的操作，例如图形的计算。这个 Scheduler 使用的固定的线程池，大小为 CPU 核数。不要把 I/O 操作放在 computation() 中，否则 I/O 操作的等待时间会浪费 CPU。</li>
<li>AndroidSchedulers.mainThread(): Android专用,它指定的操作将在 Android 主线程运行。</li>
</ul>
</li>
<li><p>指定线程的方法:</p>
<ul>
<li>Observable.subscribeOn():指定 subscribe() 所发生的线程，即 Observable.OnSubscribe 被激活时所处的线程。或者叫做事件产生的线程</li>
<li>Observable.observeOn():指定 Subscriber 所运行在的线程。或者叫做事件消费的线程。</li>
</ul>
</li>
</ul>
<h2 id="7-数据变换"><a href="#7-数据变换" class="headerlink" title="7. 数据变换:"></a>7. 数据变换:</h2><ul>
<li><p>作用: 就是将事件序列中的对象或整个序列进行加工处理，转换成不同的事件或事件序列</p>
</li>
<li><p>Observable.map:  一对一的转换</p>
<pre><code>private void simpleDemo() {
     Observable
             .just(R.mipmap.ic_launcher)
             .map(new Func1&lt;Integer, Drawable&gt;() {
                 @Override
                 public Drawable call(Integer integer) {
                     return getResources().getDrawable(integer);
                 }
             })
             .subscribe(new Action1&lt;Drawable&gt;() {
                 @Override
                 public void call(Drawable drawable) {
                     imageView.setImageDrawable(drawable);
                 }
             });
 }</code></pre></li>
<li><p>Observable.flatMap: 一对多的转换</p>
<pre><code>public class Course {
 private String name;
 private int id;

 public Course(String name, int id) {
     this.name = name;
     this.id = id;
 }

 public String getName() {
     return name;
 }

 public void setName(String name) {
     this.name = name;
 }

 public int getId() {
     return id;
 }

 public void setId(int id) {
     this.id = id;
 }
}

public class Student {
 private String name;

 private ArrayList&lt;Course&gt; courses;

 public Student(String name, ArrayList&lt;Course&gt; courses) {
     this.name = name;
     this.courses = courses;
 }

 public String getName() {
     return name;
 }

 public void setName(String name) {
     this.name = name;
 }

 public ArrayList&lt;Course&gt; getCourses() {
     return courses;
 }

 public void setCourses(ArrayList&lt;Course&gt; courses) {
     this.courses = courses;
 }
}

private void student() {

    Course yuwen = new Course(&quot;语文&quot;, 1);
    Course shuxue = new Course(&quot;数学&quot;, 2);
    Course yingyu = new Course(&quot;英文&quot;, 3);
    Course lishi = new Course(&quot;历史&quot;, 4);
    Course zhengzhi = new Course(&quot;政治&quot;, 5);
    Course xila = new Course(&quot;希腊语&quot;, 6);

    ArrayList&lt;Course&gt; course1 = new ArrayList&lt;&gt;();
    course1.add(yuwen);
    course1.add(shuxue);
    course1.add(yingyu);
             course1.add(lishi);
             course1.add(zhengzhi);
             course1.add(xila);
    Student zhangsan = new Student(&quot;zhangsan&quot;, course1);

    Observable.just(zhangsan)
            .flatMap(new Func1&lt;Student, Observable&lt;Course&gt;&gt;() {
                @Override
                public Observable&lt;Course&gt; call(Student student) {
                    return Observable.from(student.getCourses());
                }
            }).subscribe(new Action1&lt;Course&gt;() {
        @Override
        public void call(Course course) {
            System.out.println(course.getName());
        }
    });
}</code></pre></li>
</ul>
<h2 id="8-和Retrofit一起使用"><a href="#8-和Retrofit一起使用" class="headerlink" title="8. 和Retrofit一起使用"></a>8. 和Retrofit一起使用</h2><ol>
<li><p>添加依赖:</p>
<pre><code>compile &apos;com.squareup.retrofit2:retrofit:2.0.1&apos;
compile &apos;com.squareup.retrofit2:converter-gson:2.0.1&apos;
compile &apos;com.squareup.retrofit2:adapter-rxjava:2.0.1&apos;</code></pre></li>
</ol>
<ol start="2">
<li><p>利用<a href="http://www.jsonschema2pojo.org/" target="_blank" rel="noopener">http://www.jsonschema2pojo.org/</a>创建数据模型</p>
</li>
<li><p>创建REST API 接口.注意此时返回的不能是Call而是Observable.示例代码:</p>
<pre><code>public interface LocationInterface {
    // http://ip.taobao.com/service/getIpInfo.php?ip=202.178.10.23
    @GET(&quot;/service/getIpInfo.php&quot;)
    public Observable&lt;Location&gt; getLocation(@Query(&quot;ip&quot;) String ip);

}</code></pre></li>
</ol>
<ol start="4">
<li><p>创建Retrofit对象,发起请求.注意此时Retrofit需要添加addCallAdapterFactory.示例代码:</p>
<pre><code>Retrofit retrofit = new Retrofit.Builder()
         .baseUrl(BASE2)
         .addConverterFactory(GsonConverterFactory.create())
         .addCallAdapterFactory(RxJavaCallAdapterFactory.create())
         .build();

 LocationInterface locationInterface = retrofit.create(LocationInterface.class);
 Observable&lt;Location&gt; location = locationInterface.getLocation(&quot;8.8.8.8&quot;);
 location
         .subscribeOn(Schedulers.io())
         .map(new Func1&lt;Location, String&gt;() {

             @Override
             public String call(Location location) {
                 return location.getData().getCountry();
             }
         })
         .observeOn(AndroidSchedulers.mainThread())
         .subscribe(new Action1&lt;String&gt;() {
             @Override
             public void call(String s) {
                 textView.setText(s);
             }
    });</code></pre></li>
</ol>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/11/19/%E4%BB%BFQQ%E7%A9%BA%E9%97%B4%E6%89%93%E8%B5%8F%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0/" class="image is-7by1">
            <img class="thumbnail" src="/gallery/thumbnails/donate.gif" alt="仿QQ空间打赏功能实现">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-11-19T12:48:26.000Z">2017-11-19</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Android/">Android</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    几秒 读完 (大约 31 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/11/19/%E4%BB%BFQQ%E7%A9%BA%E9%97%B4%E6%89%93%E8%B5%8F%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0/">仿QQ空间打赏功能实现</a>
            
        </h1>
        <div class="content">
            <h2 id="1-preview"><a href="#1-preview" class="headerlink" title="1. preview"></a>1. preview</h2><p><img src="http://img.blog.csdn.net/20171119204708886?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvWGs2MzIxNzI3NDg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="打赏Gif"></p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/11/07/%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81%E8%8E%B7%E5%8F%96ViewPager%E4%B8%AD%E5%BD%93%E5%89%8D%E6%98%BE%E7%A4%BA%E7%9A%84Fragment/" class="image is-7by1">
            <img class="thumbnail" src="/gallery/thumbnails/viewpager.png" alt="一行代码获取ViewPager中当前显示的Fragment">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-11-06T16:25:24.000Z">2017-11-07</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Android/">Android</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    几秒 读完 (大约 63 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/11/07/%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81%E8%8E%B7%E5%8F%96ViewPager%E4%B8%AD%E5%BD%93%E5%89%8D%E6%98%BE%E7%A4%BA%E7%9A%84Fragment/">一行代码获取ViewPager中当前显示的Fragment</a>
            
        </h1>
        <div class="content">
            <h2 id="1-前言"><a href="#1-前言" class="headerlink" title="1. 前言"></a>1. 前言</h2><blockquote>
<p>我不知道网上的那些答案为什么写的那么复杂, 明明一行代码可以搞定的事情, 写的这么麻烦</p>
</blockquote>
<p> <strong>方式一 :</strong></p>
<figure class="highlight reasonml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mFragment = (MyFragment) mAdapter.instantiate<span class="hljs-constructor">Item(<span class="hljs-params">mPager</span>, <span class="hljs-params">mPager</span>.<span class="hljs-params">getCurrentItem</span>()</span>);</span><br></pre></td></tr></table></figure>

<p><strong>方式二 :</strong></p>
<figure class="highlight reasonml hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mFragment = (MyFragment) get<span class="hljs-constructor">SupportFragmentManager()</span>.find<span class="hljs-constructor">FragmentByTag(<span class="hljs-string">"android:switcher:"</span> + <span class="hljs-params">viewpager</span> + <span class="hljs-string">":"</span> + <span class="hljs-params">mViewPager</span>.<span class="hljs-params">getCurrentItem</span>()</span>);</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-image">
        <a href="/2017/09/15/hello-world/" class="image is-7by1">
            <img class="thumbnail" src="/gallery/thumbnails/helloworld.jpeg" alt="Hello World">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-09-15T11:42:44.000Z">2017-09-15</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    1 分钟 读完 (大约 121 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/09/15/hello-world/">Hello World</a>
            
        </h1>
        <div class="content">
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="hljs-string">"My New Post"</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>

        </div>
        
        
        
    </div>
</div>









    
<div class="card card-transparent">
    <nav class="pagination is-centered" role="navigation" aria-label="pagination">
        <div class="pagination-previous is-invisible is-hidden-mobile">
            <a class="is-flex-grow has-text-black-ter" href="/page/0/">上一页</a>
        </div>
        <div class="pagination-next">
            <a class="is-flex-grow has-text-black-ter" href="/page/2/">下一页</a>
        </div>
        <ul class="pagination-list is-hidden-mobile">
            
            <li><a class="pagination-link is-current" href="/">1</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/2/">2</a></li>
            
        </ul>
    </nav>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="is-rounded" src="/images/avatar.jpg" alt="Kun">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        Kun
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        青宁的博客
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>GuangZhou, China</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        文章
                    </p>
                    <a href="/archives">
                        <p class="title has-text-weight-normal">
                            11
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        分类
                    </p>
                    <a href="/categories">
                        <p class="title has-text-weight-normal">
                            4
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        标签
                    </p>
                    <a href="/tags">
                        <p class="title has-text-weight-normal">
                            7
                        </p>
                    </a>
                </div>
            </div>
        </nav>
        
        <div class="level">
            <a class="level-item button is-link is-rounded" href="http://github.com/helloxkk" target="_blank">
                关注我</a>
        </div>
        
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Github" href="http://github.com/helloxkk">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Facebook" href="https://facebook.com">
                
                <i class="fab fa-facebook"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Twitter" href="https://twitter.com">
                
                <i class="fab fa-twitter"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Dribbble" href="https://dribbble.com">
                
                <i class="fab fa-dribbble"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="RSS" href="/">
                
                <i class="fas fa-rss"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            链接
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://hexo.io" target="_blank">
                    <span class="level-left">
                        <span class="level-item">Hexo</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">hexo.io</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://github.com/ppoffice" target="_blank">
                    <span class="level-left">
                        <span class="level-item">PPOffice</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">github.com</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://www.yuque.com/xytech/flutter" target="_blank">
                    <span class="level-left">
                        <span class="level-item">闲鱼技术 · Flutter</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.yuque.com</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="http://www.ruanyifeng.com/blog/" target="_blank">
                    <span class="level-left">
                        <span class="level-item">阮一峰的个人网站</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.ruanyifeng.com</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>

    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                分类
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/Android/">
            <span class="level-start">
                <span class="level-item">Android</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/JetPack/">
            <span class="level-start">
                <span class="level-item">JetPack</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Kotlin/">
            <span class="level-start">
                <span class="level-item">Kotlin</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/ReactNative/">
            <span class="level-start">
                <span class="level-item">ReactNative</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            标签云
        </h3>
        <a href="/tags/Anko/" style="font-size: 10px;">Anko</a> <a href="/tags/LiveData/" style="font-size: 10px;">LiveData</a> <a href="/tags/React/" style="font-size: 10px;">React</a> <a href="/tags/RxJava/" style="font-size: 10px;">RxJava</a> <a href="/tags/ViewPager/" style="font-size: 10px;">ViewPager</a> <a href="/tags/%E6%80%BB%E7%BB%93/" style="font-size: 10px;">总结</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 10px;">设计模式</a>
    </div>
</div>
    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/2019/12/17/JetPack%20%E7%AE%80%E4%BB%8B/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/JetPack.jpeg" alt="JetPack 简介">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-12-17T08:01:35.734Z">2019-12-17</time></div>
                    <a href="/2019/12/17/JetPack%20%E7%AE%80%E4%BB%8B/" class="title has-link-black-ter is-size-6 has-text-weight-normal">JetPack 简介</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/JetPack/">JetPack</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/12/17/JetPack%20%E4%B9%8B%20LiveData/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/LiveData.png" alt="JetPack 之 LiveData">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-12-17T07:44:16.723Z">2019-12-17</time></div>
                    <a href="/2019/12/17/JetPack%20%E4%B9%8B%20LiveData/" class="title has-link-black-ter is-size-6 has-text-weight-normal">JetPack 之 LiveData</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/JetPack/">JetPack</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/03/17/React%20Native%20%E7%BB%84%E4%BB%B6%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/react3.gif" alt="React Native 组件生命周期学习总结">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-03-17T15:45:35.218Z">2019-03-17</time></div>
                    <a href="/2019/03/17/React%20Native%20%E7%BB%84%E4%BB%B6%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/" class="title has-link-black-ter is-size-6 has-text-weight-normal">React Native 组件生命周期学习总结</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/ReactNative/">ReactNative</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/07/25/%E4%BB%BF%E5%BE%AE%E4%BF%A1%E5%89%AA%E5%88%87%E8%A7%86%E9%A2%91%E6%97%B6%E9%95%BFView/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/thumbnail1.jpg" alt="仿微信剪切视频时长View">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-07-25T15:09:02.000Z">2018-07-25</time></div>
                    <a href="/2018/07/25/%E4%BB%BF%E5%BE%AE%E4%BF%A1%E5%89%AA%E5%88%87%E8%A7%86%E9%A2%91%E6%97%B6%E9%95%BFView/" class="title has-link-black-ter is-size-6 has-text-weight-normal">仿微信剪切视频时长View</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Android/">Android</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/06/05/%E4%BD%BF%E7%94%A8%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E8%BF%9B%E8%A1%8C%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/thumbnail3.jpg" alt="使用观察者模式进行订单管理">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-06-05T13:05:10.000Z">2018-06-05</time></div>
                    <a href="/2018/06/05/%E4%BD%BF%E7%94%A8%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E8%BF%9B%E8%A1%8C%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86/" class="title has-link-black-ter is-size-6 has-text-weight-normal">使用观察者模式进行订单管理</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Android/">Android</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            归档
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">三月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/07/">
                <span class="level-start">
                    <span class="level-item">七月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/06/">
                <span class="level-start">
                    <span class="level-item">六月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/05/">
                <span class="level-start">
                    <span class="level-item">五月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/09/">
                <span class="level-start">
                    <span class="level-item">九月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                标签
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Anko/">
                        <span class="tag">Anko</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/LiveData/">
                        <span class="tag">LiveData</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/React/">
                        <span class="tag">React</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/RxJava/">
                        <span class="tag">RxJava</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ViewPager/">
                        <span class="tag">ViewPager</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%80%BB%E7%BB%93/">
                        <span class="tag">总结</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">
                        <span class="tag">设计模式</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
        
        </div>
    
</div>


                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/2019/12/17/JetPack%20%E7%AE%80%E4%BB%8B/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/JetPack.jpeg" alt="JetPack 简介">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-12-17T08:01:35.734Z">2019-12-17</time></div>
                    <a href="/2019/12/17/JetPack%20%E7%AE%80%E4%BB%8B/" class="title has-link-black-ter is-size-6 has-text-weight-normal">JetPack 简介</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/JetPack/">JetPack</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/12/17/JetPack%20%E4%B9%8B%20LiveData/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/LiveData.png" alt="JetPack 之 LiveData">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-12-17T07:44:16.723Z">2019-12-17</time></div>
                    <a href="/2019/12/17/JetPack%20%E4%B9%8B%20LiveData/" class="title has-link-black-ter is-size-6 has-text-weight-normal">JetPack 之 LiveData</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/JetPack/">JetPack</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/03/17/React%20Native%20%E7%BB%84%E4%BB%B6%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/react3.gif" alt="React Native 组件生命周期学习总结">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-03-17T15:45:35.218Z">2019-03-17</time></div>
                    <a href="/2019/03/17/React%20Native%20%E7%BB%84%E4%BB%B6%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/" class="title has-link-black-ter is-size-6 has-text-weight-normal">React Native 组件生命周期学习总结</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/ReactNative/">ReactNative</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/07/25/%E4%BB%BF%E5%BE%AE%E4%BF%A1%E5%89%AA%E5%88%87%E8%A7%86%E9%A2%91%E6%97%B6%E9%95%BFView/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/thumbnail1.jpg" alt="仿微信剪切视频时长View">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-07-25T15:09:02.000Z">2018-07-25</time></div>
                    <a href="/2018/07/25/%E4%BB%BF%E5%BE%AE%E4%BF%A1%E5%89%AA%E5%88%87%E8%A7%86%E9%A2%91%E6%97%B6%E9%95%BFView/" class="title has-link-black-ter is-size-6 has-text-weight-normal">仿微信剪切视频时长View</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Android/">Android</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/06/05/%E4%BD%BF%E7%94%A8%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E8%BF%9B%E8%A1%8C%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/gallery/thumbnails/thumbnail3.jpg" alt="使用观察者模式进行订单管理">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-06-05T13:05:10.000Z">2018-06-05</time></div>
                    <a href="/2018/06/05/%E4%BD%BF%E7%94%A8%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E8%BF%9B%E8%A1%8C%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86/" class="title has-link-black-ter is-size-6 has-text-weight-normal">使用观察者模式进行订单管理</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Android/">Android</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            归档
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">三月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/07/">
                <span class="level-start">
                    <span class="level-item">七月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/06/">
                <span class="level-start">
                    <span class="level-item">六月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/05/">
                <span class="level-start">
                    <span class="level-item">五月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/09/">
                <span class="level-start">
                    <span class="level-item">九月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                标签
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Anko/">
                        <span class="tag">Anko</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/LiveData/">
                        <span class="tag">LiveData</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/React/">
                        <span class="tag">React</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/RxJava/">
                        <span class="tag">RxJava</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ViewPager/">
                        <span class="tag">ViewPager</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%80%BB%E7%BB%93/">
                        <span class="tag">总结</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">
                        <span class="tag">设计模式</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
    
    
</div>


            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.png" alt="青宁的博客" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2019 青宁&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-CN");</script>

<script>
var IcarusThemeSettings = {
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    }
};
</script>


    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>



    
    
<script src="/js/animation.js"></script>

    
    
<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/js/gallery.js" defer></script>

    
    
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/" target="_blank" rel="noopener">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>

    
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>
    
    
<a id="back-to-top" title="回到顶端" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>

    
    
    
    
    
    
    
    
    
    
    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="想要查找什么..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>
